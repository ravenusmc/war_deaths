{% extends 'base.html' %}

{% block body %}
<script src="https://d3js.org/d3.v4.min.js"></script>

<main>

</main>

<script>
    'use strict';

    //This will be a global variable which will be an array of objects
    //to hold all of my data in from the CSV file.
    const warData = [];

    //This function will start the d3 process by pulling the lines of code
    //from the CSV file.
    d3.csv("/my/data/endpoint", function(data) {
        for (let i = 0; i < data.length; i++){
            let war = data[i].War;
            let death = data[i].Dead;
            death = Number(death);
            warData.push({ War: war, Deaths: death })
        }
        // console.log(warData[1].War)

        let chartHolder = d3.select('main');

        let w = 800;
        let h = 300;
        let barPadding = 1;
        let margin = {top:20, right:20, bottom:30, left:40};
        let boundingRect = chartHolder.node().getBoundingClientRect();
        let width = boundingRect.width - margin.left - margin.right;
        let height = boundingRect.height - margin.top - margin.bottom;
        let barWidth = w / warData.length;

        let svg = d3.select("main").append("svg")
                .attr("width", w)
                .attr("height", h);

        // warData.forEach(function(d, i){
        //     svg.append('rect').classed('bar', true)
        //         .attr('height', d.Deaths / 10)
        //         .attr('width', barWidth)
        //         .attr('y', d.Deaths - height)
        //         .attr('x', i * (barWidth))
        //         .attr("fill", function(d) {
        //         	return "rgb(0, 0, 0)";
        //         });
        // })

        warData.forEach(function(d, i){
            svg.selectAll("rect")
                .data(warData)
                .enter()
                .append("rect")
                .attr("x", function(d, i) {
                   	return i * (w / warData.length);
                })
                .attr('y', d.Deaths - height)
                .attr("width", w / warData.length)
                .attr('height', d.Deaths / 10)
                .attr("fill", function(d) {
                    return "rgb(0, 0, 0)";
                });
                console.log()
        })

        // let dataset =[34,23,12];
        // svg.selectAll("rect")
        //    .data(dataset)
        //    .enter()
        //    .append("rect")
        //    .attr("x", function(d, i) {
        //    		return i * (w / dataset.length);
        //    })
        //    .attr("y", function(d) {
        //    		return h - (d * 4);
        //    })
        //    .attr("width", w / dataset.length - barPadding)
        //    .attr("height", function(d) {
        //    		return d * 4;
        //    })
        //    .attr("fill", function(d) {
        // 		return "rgb(0, 0, " + (d * 10) + ")";
        //    });
        //
        // svg.selectAll("text")
        //    .data(warData)
        //    .enter()
        //    .append("text")
        //    .text(function(d) {
        //    		return d;
        //    })
        //    .attr("x", function(d, i) {
        //    		return i * (w / warData.length) + 5;
        //    })
        //    .attr("y", function(d) {
        //    		return h - (d * 4) + 15;
        //    })
        //    .attr("font-family", "sans-serif")
        //    .attr("font-size", "11px")
        //    .attr("fill", "white");


    });

</script>


{% endblock %}
